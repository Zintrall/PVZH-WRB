<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PvZ Heroes Win Rate Analyzer</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Plants vs Zombies Heroes - Tournament Analysis</h1>
            <div class="explanation">
                <p>Analyze win rates and matchups from PvZ Heroes tournament data. Use the filters below to customize your analysis.</p>
            </div>
        </header>

        <div class="filters">
            <div class="filter-block">
                <h2>Data Selection</h2>
                <div class="filter-buttons">
                    <button id="dateBtn" class="filter-btn"><span>Date</span></button>
                    <button id="patchBtn" class="filter-btn active"><span>Patch</span></button>
                </div>
                <div id="dateSelector" class="selector-panel hidden">
                    <div class="date-range">
                        <div class="date-input">
                            <label for="startDate">Start Date:</label>
                            <input type="date" id="startDate">
                        </div>
                        <div class="date-input">
                            <label for="endDate">End Date:</label>
                            <input type="date" id="endDate">
                        </div>
                    </div>
                    <button id="applyDateBtn" class="apply-btn">Apply</button>
                </div>
                <div id="patchSelector" class="selector-panel">
                    <div class="checkbox-list" id="patchList">
                        <!-- Patches will be loaded dynamically -->
                    </div>
                    <div class="note">
                        <i class="fas fa-info-circle"></i> If no patches are selected, data from all patches will be used.
                    </div>
                </div>
            </div>

            <div class="filter-block">
                <h2>Tournament Selection</h2>
                <div class="checkbox-list" id="tournamentList">
                    <!-- Tournaments will be loaded dynamically -->
                </div>
                <div class="note">
                    <i class="fas fa-info-circle"></i> If no tournaments are selected, data from all tournaments will be used.
                </div>
            </div>

            <div class="filter-block">
                <h2>Player Selection</h2>
                <div class="filter-buttons">
                    <button id="playersBtn" class="filter-btn active"><span>Players</span></button>
                    <button id="opponentBtn" class="filter-btn"><span>Opponent</span></button>
                    <button id="teammateBtn" class="filter-btn"><span>Teammate</span></button>
                </div>
                <div id="playersSelector" class="selector-panel">
                    <div class="search-container">
                        <input type="text" id="playerSearch" placeholder="Search players...">
                    </div>
                    <div class="checkbox-list" id="playerList">
                        <!-- Players will be loaded dynamically -->
                    </div>
                    <button id="showMorePlayers" class="show-more-btn">Show More</button>
                    <button id="showLessPlayers" class="show-less-btn hidden">Show Less</button>
                </div>
                <div id="opponentSelector" class="selector-panel hidden">
                    <div class="search-container">
                        <input type="text" id="opponentSearch" placeholder="Search opponent...">
                    </div>
                    <select id="opponentSelect">
                        <option value="">Select an opponent</option>
                        <!-- Opponents will be loaded dynamically -->
                    </select>
                </div>
                <div id="teammateSelector" class="selector-panel hidden">
                    <div class="search-container">
                        <input type="text" id="teammateSearch" placeholder="Search teammate...">
                    </div>
                    <select id="teammateSelect">
                        <option value="">Select a teammate</option>
                        <!-- Teammates will be loaded dynamically -->
                    </select>
                </div>
            </div>

            <div class="filter-block">
                <h2>Deck Search</h2>
                <div class="deck-search">
                    <div class="deck-search-row">
                        <label for="deckHero">Hero:</label>
                        <select id="deckHero">
                            <option value="">Any Hero</option>
                            <!-- Heroes will be loaded dynamically -->
                        </select>
                    </div>
                    <div class="deck-search-row">
                        <label for="deckString">Deck contains:</label>
                        <input type="text" id="deckString" placeholder="Enter text to search in deck names...">
                    </div>
                </div>
            </div>

            <div class="filter-block">
                <button id="analyzeBtn" class="analyze-btn">Analyze Data</button>
            </div>
        </div>

        <div class="results">
            <div class="tabs">
                <button class="tab-btn active" data-tab="matchups">Hero Matchups</button>
                <button class="tab-btn" data-tab="heroes">Hero Stats</button>
                <button class="tab-btn" data-tab="players">Player Stats</button>
                <button class="tab-btn" data-tab="decks">Deck Analysis</button>
            </div>

            <div id="loadingIndicator" class="hidden">
                <div class="spinner"></div>
                <p>Processing data...</p>
            </div>

            <div id="matchupsTab" class="tab-content active">
                <div class="legend">
                    <h3>Win Rate Legend (Zombie vs Plant)</h3>
                    <div class="legend-items">
                        <div class="legend-item dark-red">< 35%</div>
                        <div class="legend-item red">35-45%</div>
                        <div class="legend-item yellow">45-55%</div>
                        <div class="legend-item light-green">55-65%</div>
                        <div class="legend-item dark-green">65%+</div>
                    </div>
                    <p class="note"><i class="fas fa-info-circle"></i> Win rates are from the Zombie's perspective. Higher percentages (green) favor Zombies.</p>
                </div>
                <div class="matchup-table-container">
                    <table id="matchupTable" class="matchup-table">
                        <!-- Matchup table will be generated dynamically -->
                    </table>
                </div>
            </div>

            <div id="heroesTab" class="tab-content hidden">
                <h3>Hero Statistics</h3>
                <div class="hero-stats-container">
                    <div class="hero-stats-section">
                        <h4>Zombie Heroes</h4>
                        <table id="zombieHeroTable" class="data-table">
                            <thead>
                                <tr>
                                    <th>Hero</th>
                                    <th>Full Name</th>
                                    <th>Games</th>
                                    <th>Win Rate</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Zombie hero stats will be loaded dynamically -->
                            </tbody>
                        </table>
                        <button id="showMoreZombies" class="show-more-btn">Show More</button>
                        <button id="showLessZombies" class="show-less-btn hidden">Show Less</button>
                    </div>

                    <div class="hero-stats-section">
                        <h4>Plant Heroes</h4>
                        <table id="plantHeroTable" class="data-table">
                            <thead>
                                <tr>
                                    <th>Hero</th>
                                    <th>Full Name</th>
                                    <th>Games</th>
                                    <th>Win Rate</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Plant hero stats will be loaded dynamically -->
                            </tbody>
                        </table>
                        <button id="showMorePlants" class="show-more-btn">Show More</button>
                        <button id="showLessPlants" class="show-less-btn hidden">Show Less</button>
                    </div>
                </div>
            </div>

            <div id="playersTab" class="tab-content hidden">
                <h3>Player Rankings</h3>
                <div class="player-stats-container">
                    <div class="player-stats-section">
                        <h4>Top Players by Win Rate (minimum 5 games)</h4>
                        <table id="playerWinRateTable" class="data-table">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Player</th>
                                    <th>Games</th>
                                    <th>Wins</th>
                                    <th>Win Rate</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Players by win rate will be loaded dynamically -->
                            </tbody>
                        </table>
                        <button id="showMoreWinratePlayers" class="show-more-btn">Show More</button>
                        <button id="showLessWinratePlayers" class="show-less-btn hidden">Show Less</button>
                    </div>

                    <div class="player-stats-section">
                        <h4>Top Players by Games Played</h4>
                        <table id="playerGamesTable" class="data-table">
                            <thead>
                                <tr>
                                    <th>Rank</th>
                                    <th>Player</th>
                                    <th>Games</th>
                                    <th>Wins</th>
                                    <th>Win Rate</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Players by games played will be loaded dynamically -->
                            </tbody>
                        </table>
                        <button id="showMoreActivePlayers" class="show-more-btn">Show More</button>
                        <button id="showLessActivePlayers" class="show-less-btn hidden">Show Less</button>
                    </div>
                </div>
            </div>

            <div id="decksTab" class="tab-content hidden">
                <h3>Deck Analysis</h3>
                <div id="deckAnalysisContent">
                    <!-- Will be populated when a player + deck search is performed -->
                    <p class="empty-state">Select a player and enter deck search criteria to see deck analysis.</p>
                </div>
            </div>
        </div>

        <div id="opponentAnalysis" class="hidden">
            <h2>Opponent Analysis: <span id="selectedOpponent"></span></h2>
            
            <div class="opponent-stats">
                <div class="opponent-section">
                    <h3>Most Played Heroes</h3>
                    <div id="opponentHeroes" class="data-container"></div>
                </div>
                
                <div class="opponent-section">
                    <h3>Lowest Win Rate Against</h3>
                    <div id="opponentWeaknesses" class="data-container"></div>
                </div>
            </div>
        </div>

        <div id="teammateAnalysis" class="hidden">
            <h2>Teammate Analysis: <span id="selectedTeammate"></span></h2>
            
            <div class="teammate-stats">
                <div class="teammate-section">
                    <h3>Heroes with Best Win Rate</h3>
                    <div id="teammateHeroes" class="data-container"></div>
                </div>
                
                <div class="teammate-section">
                    <h3>Most Played Heroes</h3>
                    <div id="teammatePlayedHeroes" class="data-container"></div>
                </div>
            </div>
        </div>

        <footer>
            <p>PvZ Heroes Tournament Analysis Tool | Data is sorted by time for efficient processing</p>
        </footer>
    </div>

    <script src="script.js"></script>
</body>
</html>